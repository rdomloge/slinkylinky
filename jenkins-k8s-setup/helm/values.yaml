tenant: "default-tenant"
# Secrets configuration
secrets:
  - name: keycloak-credentials
    type: Opaque
    data:
      # Keycloak database credentials
      KC_DB_USERNAME: "keycloak"
      KC_DB_PASSWORD: "changeme"
      JWK_SET_URI: "https://keycloak.example.com/realms/myrealm/protocol/openid-connect/certs"
      ISSUER_URI: "https://keycloak.example.com/realms/myrealm"
  - name: db-connection-secret
    type: Opaque
    data:
      # Database connection URL for Linkservice
      LINKSERVICE_DATABASE_URL: 'jdbc:postgresql://postgres-service:5432/linkservice_db'
      LINKSERVICE_DB_PASSWORD: "changeme"
      LINKSERVICE_DB_USERNAME: linkservice_user
# ConfigMaps configuration
configMaps:
  - name: rabbitmq-config
    data:
      RABBITMQ_HOST: "rabbit-service"
# Chart overrides
nameOverride: ""
fullnameOverride: ""
# ConfigMaps configuration
deployments:
  - name: linkservice
    image: "rdomloge/slinky-linky-linkservice:6.0.6-CI-34"
    cpuLimits: "1000m"
    memoryLimits: "512Mi"
    explicitEnv:
      chatgpt_model: "gpt-3.5-turbo"
      chatgpt_api_key: "<SPECIFY>"
      slinkylinky_vhost: "slinkylinky"
    secretEnv:
      spring_datasource_url: 
        secretName: db-connection-secret
        secretKey: LINKSERVICE_DATABASE_URL
      spring_datasource_password:
        secretName: db-connection-secret
        secretKey: LINKSERVICE_DB_PASSWORD
      spring_datasource_username:
        secretName: db-connection-secret
        secretKey: LINKSERVICE_DB_USERNAME
      JWK_SET_URI:
        secretName: keycloak-credentials
        secretKey: JWK_SET_URI
      ISSUER_URI:
        secretName: keycloak-credentials
        secretKey: ISSUER_URI
    configMapEnv:
      slinkylinky_rabbitmq_host:
        configMapName: rabbitmq-config
        configMapKey: RABBITMQ_HOST
    ports:
      - 5672
      - 15672
services:
  - name: postgres-service
    port: 5432
    selectorAppName: postgres
  - name: linkservice-service
    port: 8090
    targetPort: 8080
    selectorAppName: linkservice
  - name: supplierengagement-service
    port: 8091
    targetPort: 8080
    selectorAppName: supplierengagement
  - name: audit-service
    port: 8092
    targetPort: 8080
    selectorAppName: audit
  - name: stats-service
    port: 8093
    targetPort: 8080
    selectorAppName: stats
  - name: woo-service
    port: 8094
    targetPort: 8080
    selectorAppName: woo
  - name: adminwebsite-service
    port: 3000
    targetPort: 8080
    selectorAppName: adminwebsite
  - name: rabbit-service
    port: 5672
    targetPort: 5672
    selectorAppName: rabbit
  - name: rabbit-mgmt-service
    port: 15672
    targetPort: 15672
    selectorAppName: rabbit
  - name: keycloak-service
    port: 8080
    selectorAppName: keycloak